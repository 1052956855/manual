# hippo管理

这一节会用一个名为test的topic详细展示套件用户admin（为方便展示，admin是管理员）使用hippo的过程。

## HippoUI

登录到套件主页面之后，选择数据接入，如下图。

![](/数据接入/Hippo管理/enter_step1.png)

然后进入如图1-1所示页面，

![](/数据接入/Hippo管理/enter_step2.png)

                                  图1-1 套件主页面



然后选择hippo管理，计入hippo主页面 如图1-2所示。

![](/数据接入/Hippo管理/enter_step3.png)

                                                                                        图1-2 hippo主页面


如图1-2所示hippo主页面，包括左侧栏上展示的六个模块，依次是：接入列表、队列信息、集群管理、数据消费、监控、消费进展。

## 数据接入

数据接入之前需要先申请topic，topic审批通过之后，生产者才可以生产数据。通过图1-2右上角“接入申请”按钮可以进入topic的申请页面，如图1-3所示。

![](/数据接入/Hippo管理/data_input_step1.png)


                                                                                  图1-3 topic申请


topic申请需要填写一些信息，前7项都是必填项，最后一下“业务描述”用来描述业务，是可选项。如图1-3所示，必填项处已经给出了相应的提示和说明，以下是具体解释：

* topic名称：全局唯一的，不能重复；
* ip列表：用户生产topic的ip列表，多个ip之间使用分号分隔开，支持模糊匹配，申请时请添加所有有生产需求的ip；
* 队列模型：topic的队列模型，包括并发和顺序两种，并发可以提高数据消费的并发读，顺序则可以保证数据的有序，即消费的顺序和生产的顺序一致（必须是在单进程内单线程使用同步方式生产数据，如果多个进程同时生产数据则无法保证数据的顺序性）；
* 数据量：估算值，每天的生产总量；
* 峰值速率：估算值，生产数据的最大速率；
* 负责人：topic的负责人，即有权限生产此topic数据的所有用户，此处会给出tbds的用户列表，从中选取即可；
* 业务描述：辅助信息，用来描述topic。

填写完成之后，就可以提交申请，然后管理员可以在套件的“个人中心”看到这个接入申请并做审批。管理员在个人中心看到的信息如图1-4所示。

![](/数据接入/Hippo管理/data_input_step2.png)


                                                            图1-4 管理员-个人中心-审批单-hippo


管理员可以看到申请类型是HIPPO\_PRODUCE，表明这是一个接入申请，相对应的申请类型还有HIPPO\_CONSUME，表明是消费申请；还有申请人、申请时间、申请原因、申请状态等信息，最后管理员可以点击 “详情”来查看这个申请的详情，并执行审批操作，如图1-5所示。

![](/数据接入/Hippo管理/data_input_step3.png)


                                                                           图1-5 审批单详情



详情中可以看到申请时填写的信息，管理员审批时应该注意集群的选择（示例中只有一个BrokerGroup，实际场景可能会有多组），管理员可以选择BrokerGroup、指定该BrokerGroup上的新增队列数量。管理员在审批时应该根据该BrokerGroup的topic和queue数量做好资源的分配，最后执行通过或者驳回操作。


管理员审批通过一个topic之后，就可以在接入列表查看这个topic的信息，如图1-2所示。需要注意的是对于一个topic可以执行扩容或者调试操作，扩容操作仅针对于并发模型的topic，扩容界面和审批中的集群选择类似，需要勾选BrokerGroup并指定扩容的队列数量，扩容操作可以提高并发度，提升消费的速率，一般在消费滞后时使用；调试功能仅针对于顺序模型的topic，在一个顺序模型的topic生产了数据之后，通过调试功能可以查看生产数据的内容。在接入列表页面点击topic名称，可以看到topic的详细信息，如图1-6所示。

![](/数据接入/Hippo管理/data_input_step4.png)


                                                                                  图1-6 topic详细信息


详细信息中注意两点：首先是secretId和secretKey，secretId和secretKey在生产、消费时需要写到客户端配置中；sdk下载是客户端sdk的下载链接，目前只有java的sdk，客户端的使用说明参考“Hippo客户端使用”章节。

## 队列信息

队列信息按照 队列ID展示了所有topic的队列信息，也可以用来查看数据的生产状况。如图1-7所示。

![](/数据接入/Hippo管理/queue_info1.png)


                                                                       图1-7 队列信息


队列信息包括：

* Id：唯一值，用来表示queue的编号
* store名称：queue的存储单元名称
* 开始编辑时间：第一条数据的写入时间
* 最后编辑时间：最后一条数据的写入时间
* Store容量：存储单元的容量
* Offset区间：存储单元中数据的偏移量区间
* 支持写：存储单元是否支持写入

## 集群管理

集群管理展示了集群中的BrokerGroup信息，如图1-8所示。

![](/数据接入/Hippo管理/queue_info2.png)


                                                         图1-8 集群信息


集群信息包括：

* 集群名称：BrokerGroup名称
* Ip列表：BrokerGroup中各个Broker的Ip
* Topic数量：BrokerGroup上Topic的数量
* Queue数量：BrokerGroup上Queue的数量
* 上报状态：由BrokerGroup上报的BrokerGroup的读写状态
* 控制状态：由Controller设置的BrokerGroup的读写状态，管理员通过停止读/写和恢复读/写操作来改变集群的控制状态
* 操作：停止读/写，恢复读/写，主备切换

关于集群的操作，读写控制包括停止或者恢复读/写，停止读/写之后，BrokerGroup对于客户端来讲是不可读/写的；恢复读/写之后，BrokerGroup恢复读/写功能。主备切换用来切换BrokerGroup集群中Broker主备状态，如非必要，也不推荐使用。

## 数据消费

数据消费页面如图1-9所示。

![](/数据接入/Hippo管理/data_comsume_step1.png)


                                                                              图1-9数据消费


消费数据之前需要先提交消费申请，消费申请需要填写一些内容，如图1-10所示。

![](/数据接入/Hippo管理/data_comsume_step2.png)


                                                                       图1-10 新增消费


其中，前四项是必填项，“数据用途说明”是选填项。必填项包括：

* Topic名称：要申请消费的topic名称，必须是已经存在的topic
* 消费组：消费组的名称，唯一
* 数据用途：数据用途描述
* IP列表：消费客户端Ip地址列表，申请时请填入所有有消费需求的ip提交申请之后，topic的负责人可以在个人中心看到审批单（和接入申请的审批单类似），如图1-11所示。

![](/数据接入/Hippo管理/data_comsume_step3.png)


                                               图1-11 topic负责人个人中心-消费审批单


点击详情可以看到消费申请的详细信息，其详情如图1-12所示。

![](/数据接入/Hippo管理/data_comsume_step4.png)


                                                                                  图1-12 消费申请审批单


Topic的负责人根据申请内容，决定是否通过审批。审批通过的消费申请，可以在数据消费页面看到其内容，如图1-9所示。可以看到对于审批通过的消费组有个“负载均衡查看”操作，此操作可以查看正在消费的客户端的队列分配情况。

## 监控

监控页面是开放给用户用来监控消费是否跟上生产的监控工具，如图1-13所示。

![](/数据接入/Hippo管理/moniter_step1.png)


                                                                           图1-13 消费生产进度监控


页面给出topic和消费组的候选，选择topic和对应的消费组之后，就可以看到其在每个queue上的生产、消费信息，如图1-14所示。

![](/数据接入/Hippo管理/moniter_step2.png)


                                                                            图1-14 生产消费监控结果


## 消费进展

消费进展展示了每个消费组的消费情况。如图1-15所示。

![](/数据接入/Hippo管理/comsume_progress_step1.png)


                                            图1-15 消费组消费进展


由图中可以看到，group01消费了topic名称为test的数据，具体各个项目含义如下：

* Topic名称：topic的名称

* QueueId：队列queue的id

* 消费者业务ID：消费者编号

* 已提交offset：消费者已提交的消费offset

* 已拉取至offset：消费者已从服务端拉取的offset
* 提交超时时间：提交的超时时间
* 已拉取未提交数：已经从服务端拉取但是还没有执行提交的数量
* 创建时间：消费的起始时间
* 修改时间：最后一次消费的时间
